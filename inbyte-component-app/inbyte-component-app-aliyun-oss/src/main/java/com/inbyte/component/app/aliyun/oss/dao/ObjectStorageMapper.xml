<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.inbyte.component.app.aliyun.oss.dao.ObjectStorageMapper">

    <select id="detail" parameterType="Integer" resultType="com.inbyte.component.app.aliyun.oss.model.storage.ObjectStorageDetail">
        SELECT objectId,
               url,
               endPoint,
               bucket,
               mctNo,
               venueId,
               fileName,
               filePath,
               `path`,
               pathParam,
               uploaded,
               `size`,
               fileType,
               mimeType,
               uploadSource,
               height,
               width,
               remark,
               createTime,
               createUserId,
               createUserName,
               updateTime
          FROM object_storage
         WHERE objectId = #{objectId, jdbcType=INTEGER}
    </select>

    <select id="list" resultType="com.inbyte.component.app.aliyun.oss.model.storage.ObjectStorageBrief">
        SELECT objectId,
               url,
               endPoint,
               bucket,
               mctNo,
               venueId,
               fileName,
               filePath,
               `path`,
               pathParam,
               uploaded,
               `size`,
               fileType,
               mimeType,
               uploadSource,
               height,
               width,
               remark,
               createTime,
               updateTime
          FROM object_storage
         WHERE deleted = 0
        <if test="startDate != null">
           AND createTime &gt; #{startDate, jdbcType=TIMESTAMP}
        </if>
        <if test="endDate != null">
           AND createTime &lt; #{endDate, jdbcType=TIMESTAMP}
        </if>
        <if test="keyword != null and keyword != ''">
            AND (fileName LIKE CONCAT('%', #{keyword}, '%')
            OR remark LIKE CONCAT('%', #{keyword}, '%'))
        </if>
         ORDER BY objectId DESC
    </select>
</mapper>
